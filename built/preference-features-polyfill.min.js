!function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var p="function"==typeof require&&require;if(!f&&p)return p(i,!0);if(u)return u(i,!0);throw(p=new Error("Cannot find module '"+i+"'")).code="MODULE_NOT_FOUND",p}p=n[i]={exports:{}},e[i][0].call(p.exports,function(r){return o(e[i][1][r]||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}({1:[function(require,module,exports){"use strict";function removeWhitespaceFrom(string){return string.replace(/\s/g,"")}function removeSubstringFrom(string,substring){return string.replace(substring,"")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.enumKeys=exports.getTextBetweenBrackets=exports.removeUnimportantCharactersFrom=exports.removeSubstringFrom=exports.removeWhitespaceFrom=void 0,exports.removeWhitespaceFrom=removeWhitespaceFrom,exports.removeSubstringFrom=removeSubstringFrom,exports.removeUnimportantCharactersFrom=function(result){return result=removeSubstringFrom(result=result.replace(/\s/g,""),'"'),result=removeSubstringFrom(result,"'"),result=removeSubstringFrom(result,'"'),result=removeSubstringFrom(result,"'")},exports.getTextBetweenBrackets=function(text,firstBracket,lastBracket){for(var string=text.slice(text.indexOf(firstBracket)+1),openBracketsCount=1,i=0;i<string.length;i++)if(string.charAt(i)===firstBracket&&(openBracketsCount+=1),string.charAt(i)===lastBracket&&--openBracketsCount,0===openBracketsCount)return string.slice(0,i);return string},exports.enumKeys=function(obj){return Object.keys(obj).filter(function(k){return Number.isNaN(+k)})}},{}],2:[function(ScriptCoordinator,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ScriptCoordinator=void 0;var UserPreferenceViewController_1=ScriptCoordinator("../view/UserPreferenceViewController"),Reader=ScriptCoordinator("../reader/CSSReader"),Model_1=ScriptCoordinator("../model/Model"),UserPreferenceProfile_1=ScriptCoordinator("../user/UserPreferenceProfile"),JSVariableParser_1=ScriptCoordinator("../parser/JSVariableParser"),CodeParser_1=ScriptCoordinator("../parser/CodeParser"),CSSCodeParser_1=ScriptCoordinator("../parser/CSSCodeParser"),NetworkAPI_1=ScriptCoordinator("../network/NetworkAPI"),ScriptCoordinator=function(){function ScriptCoordinator(){console.log("Hello World"),console.log("-----------"),this.cssReader=new Reader.CSSReader(this),this.userProfile=this.createUserProfile(),this.rootViewController=new UserPreferenceViewController_1.UserPreferenceViewController(this.userProfile),this.codeParser=this.createCodeParser(this.userProfile)}return ScriptCoordinator.prototype.createUserProfile=function(){var network=new NetworkAPI_1.NetworkAPI;return new UserPreferenceProfile_1.UserPreferenceProfile(this,network)},ScriptCoordinator.prototype.createCodeParser=function(cssParser){var jsParser=new JSVariableParser_1.JSVariableParser(cssParser),cssParser=new CSSCodeParser_1.CSSCodeParser(cssParser,this.cssReader);return new CodeParser_1.CodeParser(jsParser,cssParser)},ScriptCoordinator.prototype.addCSSCode=function(string){this.cssReader.read(string),console.log(this.cssReader.get())},ScriptCoordinator.prototype.setAudioDescriptionEnabledValue=function(value){this.userProfile.setUserPreference(new Model_1.UserPreference(Model_1.CommonTerm.audioDescriptionEnabled,value))},ScriptCoordinator.prototype.setCaptionsEnabledValue=function(value){this.userProfile.setUserPreference(new Model_1.UserPreference(Model_1.CommonTerm.captionsEnabled,value))},ScriptCoordinator.prototype.setSignLanguageValue=function(value){this.userProfile.setUserPreference(new Model_1.UserPreference(Model_1.CommonTerm.signLanguage,value))},ScriptCoordinator.prototype.setSignLanguageEnabledValue=function(value){this.userProfile.setUserPreference(new Model_1.UserPreference(Model_1.CommonTerm.signLanguageEnabled,value))},ScriptCoordinator.prototype.setPictogramsEnabledValue=function(value){this.userProfile.setUserPreference(new Model_1.UserPreference(Model_1.CommonTerm.pictogramsEnabled,value))},ScriptCoordinator.prototype.setSelfVoicingEnabledValue=function(value){this.userProfile.setUserPreference(new Model_1.UserPreference(Model_1.CommonTerm.selfVoicingEnabled,value))},ScriptCoordinator.prototype.setSessionTimeoutValue=function(value){this.userProfile.setUserPreference(new Model_1.UserPreference(Model_1.CommonTerm.sessionTimeout,value))},ScriptCoordinator.prototype.setDisplaySkiplinksValue=function(value){this.userProfile.setUserPreference(new Model_1.UserPreference(Model_1.CommonTerm.displaySkiplinks,value))},ScriptCoordinator.prototype.setTableOfContentsValue=function(value){this.userProfile.setUserPreference(new Model_1.UserPreference(Model_1.CommonTerm.tableOfContents,value))},ScriptCoordinator.prototype.showPreferencePanel=function(){this.rootViewController.presenter.pressedShowPanel()},ScriptCoordinator.prototype.hidePreferencePanel=function(){this.rootViewController.presenter.pressedHidePanel()},ScriptCoordinator.prototype.removePreferencePanel=function(){this.rootViewController.removeView()},ScriptCoordinator.prototype.didUpdateMediaDescriptors=function(from){this.codeParser.parse(),console.log("update CSS Code!")},ScriptCoordinator.prototype.didUpdateProfile=function(from){this.codeParser.parse(),this.rootViewController.presenter.reload()},ScriptCoordinator.prototype.recievedLoginErrorMessage=function(message,from){this.rootViewController.presenter.showLoginErrorMessage(message)},ScriptCoordinator.prototype.didSelectPersona=function(persona,from){this.rootViewController.presenter.selectedPersona(persona)},ScriptCoordinator}();exports.ScriptCoordinator=ScriptCoordinator},{"../model/Model":5,"../network/NetworkAPI":6,"../parser/CSSCodeParser":8,"../parser/CodeParser":9,"../parser/JSVariableParser":10,"../reader/CSSReader":11,"../user/UserPreferenceProfile":12,"../view/UserPreferenceViewController":13}],3:[function(coordinator,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});coordinator=new(coordinator("./coordinator/ScriptCoordinator").ScriptCoordinator);window.userPreferenceSettings=coordinator},{"./coordinator/ScriptCoordinator":2}],4:[function(Factory,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Factory=void 0;var Model_1=Factory("./Model"),common=Factory("../common/utility"),utility_1=Factory("../common/utility"),Factory=function(){function Factory(){}return Factory.createMediaDescriptorsFromCSSString=function(cssCode){for(var queryString,body,regex=new RegExp("@media.(.*?).\\{","g"),matches=cssCode.matchAll(regex),result=matches.next(),mediaDescriptors=[];!result.done;)null!=result.value[1]&&null!=result.value.index&&(queryString=result.value[1],body=result.value.index,Model_1.CommonTermUtil.containsCommonTermMediaFeature(queryString)[0]&&(body=common.getTextBetweenBrackets(cssCode.slice(body),"{","}"),mediaDescriptors.push(this.createMediaDescriptorFromMQStringAndBodyString(queryString,body)))),result=matches.next();return mediaDescriptors},Factory.createMediaDescriptorFromMQStringAndBodyString=function(negated,body){for(var supportedMediaQueryString=negated,_a=this.isMediaQueryNegated(supportedMediaQueryString),negated=_a[0],supportedMediaQueryString=_a[1],supportedMediaQuery=[],unsupportedMediaQuery=[],_i=0,mediaConditions_1=this.split(supportedMediaQueryString,"and");_i<mediaConditions_1.length;_i++){var condition=mediaConditions_1[_i];Model_1.CommonTermUtil.containsCommonTermMediaFeature(condition)[0]?unsupportedMediaQuery.push(this.createMediaFeatureFrom(condition)):supportedMediaQuery.push(condition)}supportedMediaQueryString=supportedMediaQuery.join("and");return negated&&(supportedMediaQueryString="not "+supportedMediaQueryString),""==supportedMediaQueryString&&(supportedMediaQueryString=null),new Model_1.MediaDescriptor(unsupportedMediaQuery,supportedMediaQueryString,body,negated)},Factory.createCommonTermListFromMQString=function(negated){for(var supportedMediaQueryString=negated,_a=this.isMediaQueryNegated(supportedMediaQueryString),negated=_a[0],supportedMediaQueryString=_a[1],supportedMediaQuery=[],unsupportedMediaQuery=[],_i=0,mediaConditions_2=this.split(supportedMediaQueryString,"and");_i<mediaConditions_2.length;_i++){var condition=mediaConditions_2[_i];Model_1.CommonTermUtil.containsCommonTermMediaFeature(condition)[0]?unsupportedMediaQuery.push(this.createMediaFeatureFrom(condition)):supportedMediaQuery.push(condition)}supportedMediaQueryString=supportedMediaQuery.join("and");return negated&&(supportedMediaQueryString="not "+supportedMediaQueryString),""==supportedMediaQueryString&&(supportedMediaQueryString=null),new Model_1.CommonTermList(unsupportedMediaQuery,supportedMediaQueryString,negated)},Factory.createMediaFeatureFrom=function(mediaFeature){var conditionString=utility_1.removeUnimportantCharactersFrom(mediaFeature),negated=!1;conditionString.match("not")&&(negated=!0,conditionString=conditionString.replace("not",""));var value="true",mediaFeature=conditionString.match(":(.*).");null!=mediaFeature&&(value=mediaFeature[1],conditionString=conditionString.replace(":"+value,""));mediaFeature=Model_1.CommonTermUtil.containsCommonTermMediaFeature(conditionString)[1];if(null==mediaFeature||null==mediaFeature)throw new Error("There is no matching common term: "+conditionString);return new Model_1.MediaFeature(mediaFeature,negated,value)},Factory.isMediaQueryNegated=function(mediaQuery){return mediaQuery.slice(0,3).match("not")?[!0,mediaQuery.slice(4)]:[!1,mediaQuery]},Factory.split=function(mediaQuery,between){return mediaQuery.split(between)},Factory}();exports.Factory=Factory},{"../common/utility":1,"./Model":5}],5:[function(UserPreference,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SkipLinkValues=exports.Persona=exports.CommonTerm=exports.UserPreference=exports.MediaFeature=exports.CommonTermList=exports.MediaDescriptor=exports.MediaQuery=exports.CommonTermUtil=void 0;var Util=UserPreference("../common/utility"),UserPreference=function(){function CommonTermUtil(){}return CommonTermUtil.containsCommonTermMediaFeature=function(query){for(var result=[!1,null],_i=0,_a=Util.enumKeys(CommonTerm);_i<_a.length;_i++){var value=_a[_i];if(query.match(CommonTerm[value]))return[!0,CommonTerm[value]]}return result},CommonTermUtil}();exports.CommonTermUtil=UserPreference;var MediaQuery=function(unSupportedMediaQuery,supportedMediaQuery,negated){this.negated=negated,this.supportedMediaQuery=supportedMediaQuery,this.unSupportedMediaQuery=unSupportedMediaQuery};exports.MediaQuery=MediaQuery;UserPreference=function(unSupportedMediaQuery,supportedMediaQuery,body,negated){this.mediaQuery=new MediaQuery(unSupportedMediaQuery,supportedMediaQuery,negated),this.body=body};exports.MediaDescriptor=UserPreference;UserPreference=function(){function CommonTermList(unSupportedMediaQuery,supportedMediaQuery,negated){this.callbackFunction=function(){},this.mediaQuery=new MediaQuery(unSupportedMediaQuery,supportedMediaQuery,negated),this.matchValue=!1}return CommonTermList.prototype.addListener=function(event,callback){this.callbackFunction=callback},CommonTermList.prototype.matches=function(){return this.matchValue},CommonTermList.prototype.setMatchValue=function(value){this.matchValue=value},CommonTermList}();exports.CommonTermList=UserPreference;UserPreference=function(mediaFeature,negated,value){this.mediaFeature=mediaFeature,this.negated=negated,this.value=value};exports.MediaFeature=UserPreference;var CommonTerm,UserPreference=function(mediaFeature,value){this.mediaFeature=mediaFeature,this.value=value};exports.UserPreference=UserPreference,function(CommonTerm){CommonTerm.displaySkiplinks="display-skiplinks",CommonTerm.audioDescriptionEnabled="audio-description-enabled",CommonTerm.captionsEnabled="captions-enabled",CommonTerm.pictogramsEnabled="pictograms-enabled",CommonTerm.selfVoicingEnabled="self-voicing-enabled",CommonTerm.tableOfContents="table-of-contents",CommonTerm.extendedSessionTimeout="extended-session-timeout",CommonTerm.signLanguageEnabled="sign-language-enabled",CommonTerm.signLanguage="sign-language",CommonTerm.sessionTimeout="session-timeout"}(CommonTerm=exports.CommonTerm||(exports.CommonTerm={})),function(Persona){Persona.alexander="Alexander",Persona.anna="Anna",Persona.carole="Carole",Persona.lars="Lars",Persona.maria="Maria",Persona.mary="Mary",Persona.monika="Monika",Persona.susan="Susan",Persona.tom="Tom"}(exports.Persona||(exports.Persona={})),function(SkipLinkValues){SkipLinkValues.onfocus="onfocus",SkipLinkValues.always="always",SkipLinkValues.never="never"}(exports.SkipLinkValues||(exports.SkipLinkValues={}))},{"../common/utility":1}],6:[function(NetworkAPI,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.NetworkAPI=exports.NetworkUserResultUserPreference=void 0;var Model_1=NetworkAPI("../model/Model"),Personas=NetworkAPI("./Personas/Personas"),NetworkUserResultUserPreference=function(success,errorMessage,userPreferences){this.success=success,this.errorMessage=errorMessage,this.userPreferences=userPreferences};exports.NetworkUserResultUserPreference=NetworkUserResultUserPreference;NetworkAPI=function(){function NetworkAPI(){this.client=new OpenAPEClient}return NetworkAPI.prototype.loadUserContext=function(username,password){return __awaiter(this,void 0,void 0,function(){var userPreferenceArrays,userPreferences,_this=this;return __generator(this,function(_a){switch(_a.label){case 0:return _a.trys.push([0,2,,3]),[4,this.client.login(username,password)];case 1:return _a.sent(),[3,3];case 2:return _a.sent(),[2,new NetworkUserResultUserPreference(!1,"Login failed",[])];case 3:return[4,this.client.getUserContextList().then(function(result){return result["user-context-uris"]}).catch(function(err){return new NetworkUserResultUserPreference(!1,err,[])})];case 4:return userPreferenceArrays=_a.sent(),[4,Promise.all(userPreferenceArrays.map(function(context){return __awaiter(_this,void 0,void 0,function(){var _this=this;return __generator(this,function(_a){switch(_a.label){case 0:return[4,this.client.getUserContext(context).then(function(result){return _this.createUserPreferencesFromOpenAPEJSON(result)})];case 1:return[2,_a.sent()]}})})}))];case 5:return(userPreferenceArrays=_a.sent(),userPreferences=[],userPreferenceArrays.forEach(function(array){array.forEach(function(preference){userPreferences.push(preference)})}),0===userPreferences.length)?[2,new NetworkUserResultUserPreference(!1,"No suitable user context can be loaded",[])]:(this.client.token=null,[2,new NetworkUserResultUserPreference(!0,null,userPreferences)])}})})},NetworkAPI.prototype.loadPreferenceSetFromPersona=function(persona){var userPreferences;switch(persona){case Model_1.Persona.alexander:userPreferences=this.createUserPreferencesFromOpenAPEJSON(Personas.alexanderPreferences);break;case Model_1.Persona.anna:userPreferences=this.createUserPreferencesFromOpenAPEJSON(Personas.annaPreferences);break;case Model_1.Persona.carole:userPreferences=this.createUserPreferencesFromOpenAPEJSON(Personas.carolePreferences);break;case Model_1.Persona.lars:userPreferences=this.createUserPreferencesFromOpenAPEJSON(Personas.larsPreferences);break;case Model_1.Persona.maria:userPreferences=this.createUserPreferencesFromOpenAPEJSON(Personas.mariaPreferences);break;case Model_1.Persona.mary:userPreferences=this.createUserPreferencesFromOpenAPEJSON(Personas.maryPreferences);break;case Model_1.Persona.monika:userPreferences=this.createUserPreferencesFromOpenAPEJSON(Personas.monikaPreferences);break;case Model_1.Persona.susan:userPreferences=this.createUserPreferencesFromOpenAPEJSON(Personas.susanPreferences);break;case Model_1.Persona.tom:userPreferences=this.createUserPreferencesFromOpenAPEJSON(Personas.tomPreferences);break;default:userPreferences=[]}return Promise.resolve(new NetworkUserResultUserPreference(!0,null,userPreferences))},NetworkAPI.prototype.createUserPreferencesFromOpenAPEJSON=function(json){var preferences=json;void 0!==preferences.contexts&&(preferences=preferences.contexts),void 0!==preferences["gpii-default"]&&(preferences=preferences["gpii-default"]);try{preferences=preferences.preferences}catch(e){return console.log("Could not load Preferences"),console.log(e),[]}if(void 0===preferences)return[];var preferenceSet=[];try{null!=preferences["http://registry.gpii.eu/common/signLanguage"]&&preferenceSet.push(new Model_1.UserPreference(Model_1.CommonTerm.signLanguage,preferences["http://registry.gpii.eu/common/signLanguage"]+"")),null!=preferences["http://registry.gpii.eu/common/signLanguageEnabled"]&&preferenceSet.push(new Model_1.UserPreference(Model_1.CommonTerm.signLanguageEnabled,preferences["http://registry.gpii.eu/common/signLanguageEnabled"]+"")),null!=preferences["http://registry.gpii.eu/common/pictogramsEnabled"]&&preferenceSet.push(new Model_1.UserPreference(Model_1.CommonTerm.pictogramsEnabled,preferences["http://registry.gpii.eu/common/pictogramsEnabled"]+"")),null!=preferences["http://registry.gpii.eu/common/audioDescriptionEnabled"]&&preferenceSet.push(new Model_1.UserPreference(Model_1.CommonTerm.audioDescriptionEnabled,preferences["http://registry.gpii.eu/common/audioDescriptionEnabled"]+"")),null!=preferences["http://registry.gpii.eu/common/captionsEnabled"]&&preferenceSet.push(new Model_1.UserPreference(Model_1.CommonTerm.captionsEnabled,preferences["http://registry.gpii.eu/common/captionsEnabled"]+"")),null!=preferences["http://registry.gpii.eu/common/tableOfContents"]&&preferenceSet.push(new Model_1.UserPreference(Model_1.CommonTerm.tableOfContents,preferences["http://registry.gpii.eu/common/tableOfContents"]+"")),null!=preferences["http://registry.gpii.eu/common/displaySkiplinks"]&&preferenceSet.push(new Model_1.UserPreference(Model_1.CommonTerm.displaySkiplinks,preferences["http://registry.gpii.eu/common/displaySkiplinks"]+"")),null!=preferences["http://registry.gpii.eu/common/sessionTimeout"]&&preferenceSet.push(new Model_1.UserPreference(Model_1.CommonTerm.sessionTimeout,preferences["http://registry.gpii.eu/common/sessionTimeout"]+"")),null!=preferences["http://registry.gpii.eu/common/selfVoicingEnabled"]&&preferenceSet.push(new Model_1.UserPreference(Model_1.CommonTerm.selfVoicingEnabled,preferences["http://registry.gpii.eu/common/selfVoicingEnabled"]+""))}catch(e){console.log(e)}return preferenceSet},NetworkAPI}();exports.NetworkAPI=NetworkAPI;var CONSTANTS_TOKEN_PATH="/token",CONSTANTS_USER_CONTEXT_PATH="/api/user-contexts",CONSTANTS_OPENAPE_SERVER_URL="https://openape.gpii.eu",CONSTANTS_CONTENT_TYPE="application/json",OpenAPEClient=function(){function OpenAPEClient(serverUrl,contentType){void 0===serverUrl&&(serverUrl=CONSTANTS_OPENAPE_SERVER_URL),void 0===contentType&&(contentType=CONSTANTS_CONTENT_TYPE),this.arrStatusText=[],this.contentType=contentType,this.serverUrl=serverUrl,this.token=null}return OpenAPEClient.prototype.login=function(username,password){return __awaiter(this,void 0,void 0,function(){var data,_this=this;return __generator(this,function(_a){switch(_a.label){case 0:return this.isPasswordCorrect(password)&&this.isUsernameCorrect(username)?((data=new URLSearchParams).append("grant_type","password"),data.append("username",username),data.append("password",password),[4,this.fetchAPIPost(data,CONSTANTS_OPENAPE_SERVER_URL+CONSTANTS_TOKEN_PATH).then(function(response){_this.token=response.access_token})]):[3,2];case 1:return[2,_a.sent()];case 2:console.log("Passord or username are not valid."),_a.label=3;case 3:return[2]}})})},OpenAPEClient.prototype.getUserContexts=function(userContextList){return __awaiter(this,void 0,void 0,function(){var resultData,_this=this;return __generator(this,function(_a){switch(_a.label){case 0:return resultData=[],[4,userContextList.forEach(function(uri){_this.getUserContext(uri).then(function(result){resultData.push(result)}).catch(function(err){console.log(err)})})];case 1:return _a.sent(),[2,Promise.resolve(resultData)]}})})},OpenAPEClient.prototype.fetchAPIPost=function(data,url){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:return console.log("Connection will be established with server: "+url),[4,fetch(url,{method:"post",body:data}).then(function(response){return 200===response.status||201===response.status?response.json():void console.log("Looks like there was a problem. Status Code: "+response.status)}).then(function(json){return json})];case 1:return[2,_a.sent()]}})})},OpenAPEClient.prototype.fetchAPIGet=function(url){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:if(!this.isTokenCorrect(this.token))throw new Error("Token is not correct");return console.log("Connection will be established with server: "+url),[4,fetch(url,{method:"get",headers:{"Content-Type":this.contentType,Authorization:this.token}}).then(function(response){return 200===response.status||201===response.status?response.json():void console.log("Looks like there was a problem. Status Code: "+response.status)}).then(function(json){return json})];case 1:return[2,_a.sent()]}})})},OpenAPEClient.prototype.getUserContextList=function(){return __awaiter(this,void 0,void 0,function(){var err_1;return __generator(this,function(_a){switch(_a.label){case 0:return _a.trys.push([0,2,,3]),[4,this.fetchAPIGet(CONSTANTS_OPENAPE_SERVER_URL+CONSTANTS_USER_CONTEXT_PATH)];case 1:return[2,_a.sent()];case 2:throw err_1=_a.sent(),console.log("Fetch Error :-S",err_1),new Error("Loading user contexts failed");case 3:return[2]}})})},OpenAPEClient.prototype.getUserContext=function(userContextId){return __awaiter(this,void 0,void 0,function(){var err_2;return __generator(this,function(_a){switch(_a.label){case 0:if(!this.isContextIdCorrect(userContextId))throw new Error("User context is not correct");_a.label=1;case 1:return _a.trys.push([1,3,,4]),[4,this.fetchAPIGet(CONSTANTS_OPENAPE_SERVER_URL+CONSTANTS_USER_CONTEXT_PATH+"/"+userContextId)];case 2:return[2,_a.sent()];case 3:throw err_2=_a.sent(),console.log("Fetch Error :-S",err_2),new Error("Loading user context id failed");case 4:return[2]}})})},OpenAPEClient.prototype.isPasswordCorrect=function(password){var isPasswordCorrect=!0;return""==password?(console.log("Password can not be empty"),isPasswordCorrect=!1):void 0===password&&(console.log("Please enter a password"),isPasswordCorrect=!1),isPasswordCorrect},OpenAPEClient.prototype.isUsernameCorrect=function(username){var isUsernameCorrect=!0;return""==username?(this.arrStatusText.push("Username can not be empty"),isUsernameCorrect=!1):void 0===username&&(console.log("Please enter a username"),isUsernameCorrect=!1),isUsernameCorrect},OpenAPEClient.prototype.isTokenCorrect=function(token){var isTokenCorrect=!0;return null==token&&(console.log("Please initialize the library"),isTokenCorrect=!1),isTokenCorrect},OpenAPEClient.prototype.isContextIdCorrect=function(contextId){var isContextIdCorrect=!0;return""==contextId?(console.log("The contextId can not be empty"),isContextIdCorrect=!1):void 0===contextId&&(console.log("Please enter a contextId"),isContextIdCorrect=!1),isContextIdCorrect},OpenAPEClient}()},{"../model/Model":5,"./Personas/Personas":7}],7:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.examplePreferences=exports.tomPreferences=exports.susanPreferences=exports.monikaPreferences=exports.maryPreferences=exports.mariaPreferences=exports.larsPreferences=exports.carolePreferences=exports.annaPreferences=exports.alexanderPreferences=void 0,exports.alexanderPreferences={contexts:{"gpii-default":{name:"Default preferences",preferences:{"http://registry.gpii.eu/common/highContrastEnabled":!0,"http://registry.gpii.eu/common/highContrastTheme":"white-black"}}}},exports.annaPreferences={contexts:{"gpii-default":{name:"Default preferences",preferences:{"http://registry.gpii.eu/common/selfVoicingEnabled":!0,"http://registry.gpii.eu/common/pictogramsEnabled":!0,"http://registry.gpii.eu/common/sessionTimeout":1.5}}}},exports.carolePreferences={contexts:{"gpii-default":{name:"Default preferences",preferences:{"http://registry.gpii.eu/common/audioDescriptionEnabled":!0,"http://registry.gpii.eu/common/displaySkiplinks":"onfocus","http://registry.gpii.eu/common/sessionTimeout":1.8}}}},exports.larsPreferences={contexts:{"gpii-default":{name:"Default preferences",preferences:{"http://registry.gpii.eu/common/captionsEnabled":!0,"http://registry.gpii.eu/common/signLanguageEnabled":!0,"http://registry.gpii.eu/common/signLanguage":"nsl"}}}},exports.mariaPreferences={contexts:{"gpii-default":{name:"Default preferences",preferences:{"http://registry.gpii.eu/common/selfVoicingEnabled":!0,"http://registry.gpii.eu/common/sessionTimeout":1.3}}}},exports.maryPreferences={"gpii-default":{name:null,preferences:{"http://registry.gpii.eu/common/displaySkiplinks":"always","http://registry.gpii.eu/common/sessionTimeout":2}}},exports.monikaPreferences={contexts:{"gpii-default":{name:"Default preferences",preferences:{"http://registry.gpii.eu/common/selfVoicingEnabled":!0,"http://registry.gpii.eu/common/pictogramsEnabled":!0,"http://registry.gpii.eu/common/sessionTimeout":2}}}},exports.susanPreferences={contexts:{"gpii-default":{name:"Default preferences",preferences:{"http://registry.gpii.eu/common/captionsEnabled":!0}}}},exports.tomPreferences={contexts:{"gpii-default":{name:"Default preferences",preferences:{"http://registry.gpii.eu/common/displaySkiplinks":"onfocus"}}}},exports.examplePreferences={contexts:{"gpii-default":{name:"Default preferences",preferences:{"http://registry.gpii.eu/common/signLanguage":"es","http://registry.gpii.eu/common/signLanguageEnabled":!0,"http://registry.gpii.eu/common/pictogramsEnabled":!0,"http://registry.gpii.eu/common/audioDescriptionEnabled":!0,"http://registry.gpii.eu/common/captionsEnabled":!0,"http://registry.gpii.eu/common/tableOfContents":!1,"http://registry.gpii.eu/common/displaySkiplinks":"some","http://registry.gpii.eu/common/sessionTimeout":1.2,"http://registry.gpii.eu/common/selfVoicingEnabled":!0}}}}},{}],8:[function(CSSCodeParser,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CSSCodeParser=void 0;var Model_1=CSSCodeParser("../model/Model"),CSSCodeParser=function(){function CSSCodeParser(userPreferenceProfile,cssReader){this.styleId="common-terms-media-queries",this.cssReader=cssReader,this.userProfile=userPreferenceProfile}return CSSCodeParser.prototype.parse=function(){this.resetCSSCode();var cssCode=this.createCSSCode();this.parseCSSCode(cssCode)},CSSCodeParser.prototype.createCSSCode=function(){for(var cssStyle=[],mediaDescriptors=this.cssReader.get(),i=0;i<mediaDescriptors.length;i++){var cssCode,mediaDescriptor=mediaDescriptors[i];this.userProfile.doesMediaQueryMatch(mediaDescriptor.mediaQuery)&&(cssCode=mediaDescriptor.body,null!==mediaDescriptor.mediaQuery.supportedMediaQuery&&(cssCode="@media "+mediaDescriptor.mediaQuery.supportedMediaQuery+" {\n"+cssCode+"\n}"),cssStyle.push(cssCode))}return this.createCSSVariables()+cssStyle.join("\n")},CSSCodeParser.prototype.parseCSSCode=function(cssCode){var style=document.createElement("style");style.setAttribute("id",this.styleId),style.innerHTML=cssCode,document.head.appendChild(style)},CSSCodeParser.prototype.resetCSSCode=function(){var style=document.getElementById(this.styleId);null!=style&&style.remove()},CSSCodeParser.prototype.createCSSVariables=function(){for(var variables=["--audio-description-enabled: "+this.userProfile.getValueForMediaFeature(Model_1.CommonTerm.audioDescriptionEnabled),"--captions-enabled: "+this.userProfile.getValueForMediaFeature(Model_1.CommonTerm.captionsEnabled),"--self-voicing-enabled: "+this.userProfile.getValueForMediaFeature(Model_1.CommonTerm.selfVoicingEnabled),"--session-timeout: "+this.userProfile.getValueForMediaFeature(Model_1.CommonTerm.sessionTimeout),"--extended-session-timeout: "+this.userProfile.getValueForMediaFeature(Model_1.CommonTerm.extendedSessionTimeout),"--sign-language: "+this.userProfile.getValueForMediaFeature(Model_1.CommonTerm.signLanguage),"--sign-language-enabled: "+this.userProfile.getValueForMediaFeature(Model_1.CommonTerm.signLanguageEnabled),"--table-of-contents: "+this.userProfile.getValueForMediaFeature(Model_1.CommonTerm.tableOfContents),"--display-skiplinks: "+this.userProfile.getValueForMediaFeature(Model_1.CommonTerm.displaySkiplinks)],pseudoRootClass=":root {\n",i=0;i<variables.length;i++)pseudoRootClass=pseudoRootClass+"   "+variables[i]+";\n";return pseudoRootClass+"}\n\n"},CSSCodeParser}();exports.CSSCodeParser=CSSCodeParser},{"../model/Model":5}],9:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CodeParser=void 0;var CodeParser=function(){function CodeParser(jsVariableParser,cssCodeParser){this.cssParser=cssCodeParser,this.jsParser=jsVariableParser}return CodeParser.prototype.parse=function(){this.jsParser.parse(),this.cssParser.parse()},CodeParser}();exports.CodeParser=CodeParser},{}],10:[function(JSVariableParser,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.JSVariableParser=void 0;var Model_1=JSVariableParser("../model/Model"),Factory_1=JSVariableParser("../model/Factory"),JSVariableParser=function(){function JSVariableParser(userPreferenceProfile){var _this=this;this.commonTermLists=[],this.userProfile=userPreferenceProfile,this.parse(),window.matchCommonTermMedia=function(string){return _this.createCommonTermList(string)}}return JSVariableParser.prototype.createCommonTermList=function(matchValue){var list=Factory_1.Factory.createCommonTermListFromMQString(matchValue),matchValue=this.evaluateCommonTermList(list);return list.setMatchValue(matchValue),this.commonTermLists.push(list),list},JSVariableParser.prototype.parse=function(){for(var userPreferences=this.userProfile.getUserPreferences(),i=0;i<userPreferences.length;i++)this.setJSVariableForUserPreference(userPreferences[i]);this.evaluateCommonTermLists()},JSVariableParser.prototype.evaluateCommonTermLists=function(){for(var i=0;i<this.commonTermLists.length;i++){var newValue=this.evaluateCommonTermList(this.commonTermLists[i]);this.commonTermLists[i].matches()!=newValue&&(this.commonTermLists[i].setMatchValue(newValue),this.commonTermLists[i].callbackFunction())}},JSVariableParser.prototype.evaluateCommonTermList=function(list){return console.log(list),this.userProfile.doesMediaQueryMatch(list.mediaQuery)?(console.log("1"),null!==list.mediaQuery.supportedMediaQuery?(console.log("2"),this.evaluateMediaQuery(list.mediaQuery.supportedMediaQuery)):(console.log("3"),!0)):(console.log("4"),!1)},JSVariableParser.prototype.evaluateMediaQuery=function(mediaQuery){return window.matchMedia(mediaQuery).matches},JSVariableParser.prototype.setJSVariableForUserPreference=function(userPreference){switch(userPreference.mediaFeature){case Model_1.CommonTerm.audioDescriptionEnabled:window.audioDescriptionEnabled=userPreference.value;break;case Model_1.CommonTerm.captionsEnabled:window.captionsEnabled=userPreference.value;break;case Model_1.CommonTerm.displaySkiplinks:window.displaySkiplinks=userPreference.value;break;case Model_1.CommonTerm.extendedSessionTimeout:window.extendedSessionTimeout=userPreference.value;break;case Model_1.CommonTerm.pictogramsEnabled:window.pictogramsEnabled=userPreference.value;break;case Model_1.CommonTerm.selfVoicingEnabled:window.selfVoicingEnabled=userPreference.value;break;case Model_1.CommonTerm.sessionTimeout:window.sessionTimeout=userPreference.value;break;case Model_1.CommonTerm.signLanguage:window.signLanguage=userPreference.value;break;case Model_1.CommonTerm.signLanguageEnabled:window.signLanguageEnabled=userPreference.value;break;case Model_1.CommonTerm.tableOfContents:window.tableOfContents=userPreference.value}},JSVariableParser}();exports.JSVariableParser=JSVariableParser},{"../model/Factory":4,"../model/Model":5}],11:[function(CSSReader,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.CSSReader=void 0;var Factory=CSSReader("../model/Factory"),CSSReader=function(){function CSSReader(delegate){this.mediaDescriptors=[],this.plainCSS=[],this.delegate=delegate,this.readAutomatic()}return CSSReader.prototype.get=function(){return this.mediaDescriptors},CSSReader.prototype.read=function(string){this.plainCSS.includes(string)?console.log("CSS Code is already included"):(this.plainCSS.push(string),this.refresh())},CSSReader.prototype.readAutomatic=function(){return __awaiter(this,void 0,void 0,function(){var stylesSheets,i,text;return __generator(this,function(_a){switch(_a.label){case 0:stylesSheets=document.querySelectorAll("link"),i=stylesSheets.length,_a.label=1;case 1:return i--?"stylesheet"!==stylesSheets[i].getAttribute("rel")?[3,3]:(text=stylesSheets[i].getAttribute("href"),[4,this.loadCSSFile(text).then(function(text){return text})]):[3,4];case 2:text=_a.sent(),this.read(text),_a.label=3;case 3:return[3,1];case 4:return[2]}})})},CSSReader.prototype.refresh=function(){var plainCSSCodeString;0!=this.plainCSS.length&&(plainCSSCodeString=this.plainCSS.reverse().join("\n"),this.mediaDescriptors=Factory.Factory.createMediaDescriptorsFromCSSString(plainCSSCodeString)),this.delegate.didUpdateMediaDescriptors(this)},CSSReader.prototype.reset=function(){this.mediaDescriptors=[],this.plainCSS=[],this.refresh()},CSSReader.prototype.loadCSSFile=function(link){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:return[4,fetch(link,{method:"get"}).then(function(response){return response.text()})];case 1:return[2,_a.sent()]}})})},CSSReader}();exports.CSSReader=CSSReader},{"../model/Factory":4}],12:[function(UserPreferenceProfile,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.UserPreferenceProfile=void 0;var Model=UserPreferenceProfile("../model/Model"),Model_1=UserPreferenceProfile("../model/Model"),UserPreferenceProfile=function(){function UserPreferenceProfile(delegate,network){this.userPreferences=[],this.setDefaultValues(),this.delegate=delegate,this.network=network}return UserPreferenceProfile.prototype.refresh=function(){this.delegate.didUpdateProfile(this),console.log(this.userPreferences)},UserPreferenceProfile.prototype.setDefaultValues=function(){this.userPreferences=defaultPreferences.slice(),console.log("_-----------"),console.log(defaultPreferences),console.log("_-----------")},UserPreferenceProfile.prototype.login=function(username,password){var _this=this;this.network.loadUserContext(username,password).then(function(result){return result.success&&_this.setUserPreferences(result.userPreferences),result.success||null==result.errorMessage||_this.delegate.recievedLoginErrorMessage(result.errorMessage,_this),result})},UserPreferenceProfile.prototype.doesMediaFeatureMatch=function(mediaFeature){for(var k=0;k<this.userPreferences.length;k++){var preference=this.userPreferences[k];if(mediaFeature.mediaFeature===preference.mediaFeature&&(mediaFeature.value!==preference.value&&!mediaFeature.negated||mediaFeature.value===preference.value&&mediaFeature.negated))return!1}return!0},UserPreferenceProfile.prototype.doesMediaQueryMatch=function(mediaQuery){for(var i=0;i<mediaQuery.unSupportedMediaQuery.length;i++){var matchValue=mediaQuery.unSupportedMediaQuery[i],matchValue=this.doesMediaFeatureMatch(matchValue);if(mediaQuery.negated&&matchValue||!matchValue&&!mediaQuery.negated)return!1}return!0},UserPreferenceProfile.prototype.getValueForMediaFeature=function(mediaFeature){for(var i=0;i<this.userPreferences.length;i++)if(this.userPreferences[i].mediaFeature==mediaFeature)return this.userPreferences[i].value;for(i=0;i<defaultPreferences.length;i++)if(defaultPreferences[i].mediaFeature==mediaFeature)return this.userPreferences[i].value;return""},UserPreferenceProfile.prototype.getUserPreferences=function(){return this.userPreferences},UserPreferenceProfile.prototype.changeUserPreference=function(preference){for(var i=0;i<this.userPreferences.length;i++)if(this.userPreferences[i].mediaFeature==preference.mediaFeature)return void((this.userPreferences[i]=preference).mediaFeature==Model_1.CommonTerm.sessionTimeout&&(1<parseFloat(preference.value)?this.changeUserPreference(new Model_1.UserPreference(Model_1.CommonTerm.extendedSessionTimeout,"true")):this.changeUserPreference(new Model_1.UserPreference(Model_1.CommonTerm.extendedSessionTimeout,"false"))))},UserPreferenceProfile.prototype.setUserPreferences=function(preferences){this.setDefaultValues();for(var i=0;i<preferences.length;i++)this.changeUserPreference(preferences[i]);this.refresh()},UserPreferenceProfile.prototype.setUserPreference=function(preference){this.changeUserPreference(preference),this.refresh()},UserPreferenceProfile.prototype.selectPersona=function(persona){var _this=this;this.network.loadPreferenceSetFromPersona(persona).then(function(result){return result.success&&(_this.setUserPreferences(result.userPreferences),_this.delegate.didSelectPersona(persona,_this)),result})},UserPreferenceProfile}();exports.UserPreferenceProfile=UserPreferenceProfile;var defaultPreferences=[new Model.UserPreference(Model_1.CommonTerm.audioDescriptionEnabled,"false"),new Model.UserPreference(Model_1.CommonTerm.captionsEnabled,"false"),new Model.UserPreference(Model_1.CommonTerm.displaySkiplinks,"never"),new Model.UserPreference(Model_1.CommonTerm.extendedSessionTimeout,"false"),new Model.UserPreference(Model_1.CommonTerm.pictogramsEnabled,"false"),new Model.UserPreference(Model_1.CommonTerm.selfVoicingEnabled,"false"),new Model.UserPreference(Model_1.CommonTerm.sessionTimeout,"1"),new Model.UserPreference(Model_1.CommonTerm.signLanguage,""),new Model.UserPreference(Model_1.CommonTerm.signLanguageEnabled,"false"),new Model.UserPreference(Model_1.CommonTerm.tableOfContents,"true")]},{"../model/Model":5}],13:[function(UserPreferenceViewController,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.UserPreferencePresenter=exports.UserPreferenceViewController=void 0;var UserPreferenceViews_1=UserPreferenceViewController("./UserPreferenceViews"),UserPreferenceViewController=function(){function UserPreferenceViewController(userProfile){this.element=new UserPreferenceViews_1.HTMLBasicElement("div","wrapper",null),this.panelWrapper=new UserPreferenceViews_1.HTMLBasicElement("div","panel-wrapper",null),this.headerWrapper=new UserPreferenceViews_1.HeaderWrapperView(this),this.personaWrapper=new UserPreferenceViews_1.PersonasWrapperView(this),this.listWrapper=new UserPreferenceViews_1.ListWrapperView(this),this.applyButtonWrapper=new UserPreferenceViews_1.ApplyButtonWrapperView(this),this.loginWrapper=new UserPreferenceViews_1.LoginWrapperView(this),this.showPanelButton=new UserPreferenceViews_1.OpenButtonView(this),this.presenter=new UserPreferencePresenter(this,userProfile),this.createView(),this.parseView(),this.presenter.viewDidLoad()}return UserPreferenceViewController.prototype.createView=function(){this.panelWrapper.appendChild(this.headerWrapper.element),this.panelWrapper.appendChild(this.personaWrapper.element),this.panelWrapper.appendChild(this.listWrapper.element),this.panelWrapper.appendChild(this.loginWrapper.element),this.panelWrapper.appendChild(this.applyButtonWrapper.element),this.element.appendChild(this.showPanelButton.element),this.element.appendChild(this.panelWrapper)},UserPreferenceViewController.prototype.parseView=function(){null==document.body&&null==document.body||document.body.appendChild(this.element.element)},UserPreferenceViewController.prototype.removeView=function(){var child;null!=this.element.id&&(null==(child=document.getElementById(this.element.id))&&null==child||document.body.removeChild(child))},UserPreferenceViewController.prototype.showPanel=function(){this.panelWrapper.element.style.right="2vh",this.showPanelButton.element.element.style.right="-200px"},UserPreferenceViewController.prototype.hidePanel=function(){this.panelWrapper.element.style.right="-400px",this.showPanelButton.element.element.style.right="2vh"},UserPreferenceViewController.prototype.selectUserPreferences=function(userPreferences){for(var i=0;i<userPreferences.length;i++)this.listWrapper.setPreferences(userPreferences[i])},UserPreferenceViewController.prototype.showLoginErrorMessage=function(message){this.loginWrapper.showErrorMessage(message)},UserPreferenceViewController.prototype.selectPersona=function(persona){this.personaWrapper.selectPersona(persona)},UserPreferenceViewController.prototype.unselectAllPersona=function(){this.personaWrapper.unselectAllPersonas()},UserPreferenceViewController.prototype.getAllSetPreferences=function(){return this.listWrapper.getAllPreferences()},UserPreferenceViewController.prototype.didSelectPersona=function(persona,from){console.log("Did select hier "+persona),this.presenter.selectPersona(persona)},UserPreferenceViewController.prototype.didPressApply=function(from){this.presenter.pressedApplyPreferences()},UserPreferenceViewController.prototype.didPressCancel=function(from){this.presenter.pressedCancel()},UserPreferenceViewController.prototype.didEditPreferences=function(from){this.presenter.editPreferences()},UserPreferenceViewController.prototype.didPressLogin=function(username,password,from){this.presenter.pressedLogin(username,password)},UserPreferenceViewController.prototype.didPressHidePanel=function(from){this.presenter.pressedHidePanel()},UserPreferenceViewController.prototype.didPressShowPanel=function(from){this.presenter.pressedShowPanel()},UserPreferenceViewController}();exports.UserPreferenceViewController=UserPreferenceViewController;var UserPreferencePresenter=function(){function UserPreferencePresenter(view,userProfile){this.userProfile=userProfile,this.view=view}return UserPreferencePresenter.prototype.viewDidLoad=function(){this.reload()},UserPreferencePresenter.prototype.reload=function(){this.refreshView()},UserPreferencePresenter.prototype.pressedCancel=function(){this.reload()},UserPreferencePresenter.prototype.editPreferences=function(){this.view.unselectAllPersona()},UserPreferencePresenter.prototype.pressedLogin=function(username,password){this.userProfile.login(username,password),this.reload()},UserPreferencePresenter.prototype.pressedApplyPreferences=function(){this.userProfile.setUserPreferences(this.view.getAllSetPreferences()),this.reload()},UserPreferencePresenter.prototype.pressedShowPanel=function(){this.view.showPanel()},UserPreferencePresenter.prototype.pressedHidePanel=function(){this.view.hidePanel(),this.reload()},UserPreferencePresenter.prototype.selectPersona=function(persona){this.userProfile.selectPersona(persona)},UserPreferencePresenter.prototype.selectedPersona=function(persona){this.view.unselectAllPersona(),this.view.selectPersona(persona),this.reload()},UserPreferencePresenter.prototype.showLoginErrorMessage=function(message){this.view.showLoginErrorMessage(message)},UserPreferencePresenter.prototype.refreshView=function(){this.view.selectUserPreferences(this.userProfile.getUserPreferences()),console.log(this.userProfile.getUserPreferences())},UserPreferencePresenter}();exports.UserPreferencePresenter=UserPreferencePresenter},{"./UserPreferenceViews":14}],14:[function(OpenButtonView,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.OpenButtonView=exports.LoginWrapperView=exports.ListWrapperView=exports.HeaderWrapperView=exports.ApplyButtonWrapperView=exports.LabelButtonView=exports.ImageButtonView=exports.RadioButtonView=exports.SwitchControlView=exports.PersonasWrapperView=exports.HTMLUserInputElement=exports.HTMLImageElement=exports.HTMLTextElement=exports.HTMLBasicElement=void 0;var Model_1=OpenButtonView("../model/Model"),HTMLBasicElement=function(){function HTMLBasicElement(element,id,classString){this.id=null,this.class=null,this.type=element;element=document.createElement(this.type);""!=id&&null!=id&&(this.id="user-preference-view-"+id,element.setAttribute("id",this.id)),""!=classString&&null!=classString&&(this.class="user-preference-view-"+classString,element.setAttribute("class",this.class)),this.element=element}return HTMLBasicElement.prototype.appendChild=function(child){this.element.appendChild(child.element)},HTMLBasicElement.prototype.appendChildren=function(children){for(var i=0;i<children.length;i++)this.element.appendChild(children[i].element)},HTMLBasicElement.prototype.setAttribute=function(attribute,value){this.element.setAttribute(attribute,value)},HTMLBasicElement.prototype.addClickEventListener=function(listener){this.element.addEventListener("click",listener)},HTMLBasicElement}(),HTMLTextElement=function(_super){function HTMLTextElement(type,id,_this,text){_this=_super.call(this,type,id,_this)||this;return _this.appendText(text),_this}return __extends(HTMLTextElement,_super),HTMLTextElement.prototype.appendText=function(textNode){textNode=document.createTextNode(textNode);this.element.appendChild(textNode)},HTMLTextElement.prototype.clearText=function(){this.element.textContent=""},HTMLTextElement}(exports.HTMLBasicElement=HTMLBasicElement);exports.HTMLTextElement=HTMLTextElement;var HTMLImageElement=function(_super){function HTMLImageElement(type,id,_this,src,alt){_this=_super.call(this,type,id,_this)||this;return _this.setAttribute("src",src),_this.setAttribute("alt",alt),_this}return __extends(HTMLImageElement,_super),HTMLImageElement}(HTMLBasicElement);exports.HTMLImageElement=HTMLImageElement;var HTMLUserInputElement=function(){function HTMLUserInputElement(type,id,classString,placeholder){this.class=null,this.id=null,this.type="input";var element=document.createElement(this.type);element.setAttribute("type",type),""!=id&&null!=id&&(this.id="user-preference-view-"+id,element.setAttribute("id",this.id)),""!=classString&&null!=classString&&(this.class="user-preference-view-"+classString,element.setAttribute("class",this.class)),""!=placeholder&&null!=placeholder&&element.setAttribute("placeholder",placeholder),this.element=element}return HTMLUserInputElement.prototype.setValue=function(value){this.element.value=value},HTMLUserInputElement.prototype.getValue=function(){return this.element.value},HTMLUserInputElement.prototype.getCheckedValue=function(){return this.element.checked},HTMLUserInputElement.prototype.setCheckedValue=function(value){this.element.checked=value},HTMLUserInputElement.prototype.appendChild=function(child){this.element.appendChild(child.element)},HTMLUserInputElement.prototype.appendChildren=function(children){for(var i=0;i<children.length;i++)this.element.appendChild(children[i].element)},HTMLUserInputElement.prototype.setAttribute=function(attribute,value){this.element.setAttribute(attribute,value)},HTMLUserInputElement.prototype.setChangeEventListener=function(changeCall){this.element.addEventListener("change",changeCall)},HTMLUserInputElement}();exports.HTMLUserInputElement=HTMLUserInputElement;var PersonaView=function(){function PersonaView(name,element){this.imageElement=new HTMLImageElement("img",null,"persona-image",element,"Zeichnung aus den Alltagsbeschreibungen"),this.nameElement=new HTMLTextElement("p",null,"persona-label",name);element=new HTMLBasicElement("div",null,"persona-div");element.appendChildren([this.imageElement,this.nameElement]),this.element=element,this.name=name}return PersonaView.prototype.select=function(){this.element.setAttribute("id","user-preference-persona-selected")},PersonaView.prototype.unselect=function(){this.element.element.removeAttribute("id")},PersonaView}(),OpenButtonView=function(){function PersonasWrapperView(delegate){var _this=this;this.alexanderODSView=new PersonaView(Model_1.Persona.alexander,"https://gpii.eu/mq-5/assets/Alexander.png"),this.annaODSView=new PersonaView(Model_1.Persona.anna,"https://gpii.eu/mq-5/assets/Anna.png"),this.caroleODSView=new PersonaView(Model_1.Persona.carole,"https://gpii.eu/mq-5/assets/Carole.png"),this.larsODSView=new PersonaView(Model_1.Persona.lars,"https://gpii.eu/mq-5/assets/Lars.png"),this.mariaODSView=new PersonaView(Model_1.Persona.maria,"https://gpii.eu/mq-5/assets/Maria.png"),this.maryODSView=new PersonaView(Model_1.Persona.mary,"https://gpii.eu/mq-5/assets/Mary.png"),this.monikaODSView=new PersonaView(Model_1.Persona.monika,"https://gpii.eu/mq-5/assets/Monika.png"),this.susanODSView=new PersonaView(Model_1.Persona.susan,"https://gpii.eu/mq-5/assets/Susan.png"),this.tomODSView=new PersonaView(Model_1.Persona.tom,"https://gpii.eu/mq-5/assets/Tom.png"),this.personaViews=[this.alexanderODSView,this.annaODSView,this.caroleODSView,this.larsODSView,this.mariaODSView,this.maryODSView,this.monikaODSView,this.susanODSView,this.tomODSView];for(var element=new HTMLBasicElement("div","personas-wrapper",null),this_1=this,i=0;i<this.personaViews.length;i++)!function(i){this_1.personaViews[i].element.addClickEventListener(function(){_this.delegate.didSelectPersona(_this.personaViews[i].name,_this)}),element.appendChild(this_1.personaViews[i].element)}(i);this.element=element,this.delegate=delegate}return PersonasWrapperView.prototype.selectPersona=function(persona){for(var i=0;i<this.personaViews.length;i++)this.personaViews[i].name===persona&&this.personaViews[i].select()},PersonasWrapperView.prototype.unselectAllPersonas=function(){for(var i=0;i<this.personaViews.length;i++)this.personaViews[i].unselect()},PersonasWrapperView}();exports.PersonasWrapperView=OpenButtonView;var SwitchControlView=function(){function SwitchControlView(name){this.checkBoxElement=new HTMLUserInputElement("checkbox",name+"-switcher","switch-input",null),this.checkBoxElement.setCheckedValue(!0),this.spanElement=new HTMLBasicElement("span",null,"slider round"),this.element=new HTMLBasicElement("label",null,"switch-control"),this.element.appendChildren([this.checkBoxElement,this.spanElement])}return SwitchControlView.prototype.setCheckedValue=function(value){this.checkBoxElement.setCheckedValue(value)},SwitchControlView.prototype.getCheckedValue=function(){return this.checkBoxElement.getCheckedValue()},SwitchControlView.prototype.setChangeEventListener=function(changeCall){this.checkBoxElement.setChangeEventListener(changeCall)},SwitchControlView}();exports.SwitchControlView=SwitchControlView;var RadioButtonView=function(){function RadioButtonView(name,values){this.element=new HTMLBasicElement("div",null,"radio-label"),this.inputs=[];for(var i=0;i<values.length;i++){var input=new HTMLUserInputElement("radio",name+"-radio","radio-input",null);input.setAttribute("name",name),input.setAttribute("value",""+values[i]);var label=new HTMLTextElement("label",null,null,""+values[i]);label.setAttribute("for",""+values[i]);var div=new HTMLBasicElement("div",null,"radio-div");div.appendChildren([input,label]),this.element.appendChild(div),this.inputs.push(input)}}return RadioButtonView.prototype.getValue=function(){for(var i=0;i<this.inputs.length;i++)if(this.inputs[i].getCheckedValue())return this.inputs[i].getValue();return""},RadioButtonView.prototype.setValue=function(value){for(var i=0;i<this.inputs.length;i++)this.inputs[i].getValue()==value&&this.inputs[i].setCheckedValue(!0)},RadioButtonView}();exports.RadioButtonView=RadioButtonView;var ImageButtonView=function(_super){function ImageButtonView(id,_this,imagePath,imageNode,functionCall){_this=_super.call(this,"span",id,_this)||this,imageNode=new HTMLImageElement("img","close-button-image","",imagePath,imageNode);return _this.element.appendChild(imageNode.element),_this.addClickEventListener(functionCall),_this}return __extends(ImageButtonView,_super),ImageButtonView}(HTMLBasicElement);exports.ImageButtonView=ImageButtonView;var LabelButtonView=function(_super){function LabelButtonView(id,_this,textNode,functionCall){_this=_super.call(this,"button",id,_this)||this;_this.element.setAttribute("type","button");textNode=document.createTextNode(textNode);return _this.element.appendChild(textNode),_this.addClickEventListener(functionCall),_this}return __extends(LabelButtonView,_super),LabelButtonView}(HTMLBasicElement);exports.LabelButtonView=LabelButtonView;OpenButtonView=function(){function ApplyButtonWrapperView(element){var _this=this;this.applyButton=new LabelButtonView("apply-button","button","Apply Preferences",function(){return _this.applyPreferences()}),this.cancelButton=new LabelButtonView("cancel-button","button","Cancel",function(){return _this.cancel()}),this.delegate=element;element=new HTMLBasicElement("div",null,"apply-button-wrapper");element.appendChildren([this.cancelButton,this.applyButton]),this.element=element}return ApplyButtonWrapperView.prototype.applyPreferences=function(){this.delegate.didPressApply(this)},ApplyButtonWrapperView.prototype.cancel=function(){this.delegate.didPressCancel(this)},ApplyButtonWrapperView.prototype.hideButtons=function(){},ApplyButtonWrapperView.prototype.showButtons=function(){},ApplyButtonWrapperView}();exports.ApplyButtonWrapperView=OpenButtonView;OpenButtonView=function(){function HeaderWrapperView(element){var _this=this;this.headline=new HTMLTextElement("h1",null,null,"User Preferences"),this.hidePanelButton=new ImageButtonView("hide-panel-button","button","https://gpii.eu/mq-5/assets/close.svg","Close Button",function(){return _this.hidePanel()}),this.delegate=element;element=new HTMLBasicElement("div",null,"header-view-wrapper");element.appendChildren([this.headline,this.hidePanelButton]),this.element=element}return HeaderWrapperView.prototype.hidePanel=function(){this.delegate.didPressHidePanel(this)},HeaderWrapperView}();exports.HeaderWrapperView=OpenButtonView;var CommonTermListEntryBooleanView=function(){function CommonTermListEntryBooleanView(name,element,valueChangedCall){this.label=new HTMLTextElement("p",null,"list-entry-label",name),this.input=new SwitchControlView(element),this.commonTerm=element;element=new HTMLBasicElement("div",null,"ct-list-entry-div");element.appendChildren([this.label,this.input.element]),this.element=element,this.input.setChangeEventListener(valueChangedCall)}return CommonTermListEntryBooleanView.prototype.setValue=function(value){"true"==value?this.input.setCheckedValue(!0):this.input.setCheckedValue(!1)},CommonTermListEntryBooleanView.prototype.getValue=function(){return this.input.getCheckedValue()+""},CommonTermListEntryBooleanView}(),CommonTermListEntryTextInputView=function(){function CommonTermListEntryTextInputView(name,element,valueChangedCall){this.label=new HTMLTextElement("p",null,"list-entry-label",name),this.input=new HTMLUserInputElement("text",element+"-input","text-input",null),this.commonTerm=element;element=new HTMLBasicElement("div",null,"ct-list-entry-div");element.appendChildren([this.label,this.input]),this.element=element,this.input.setChangeEventListener(valueChangedCall)}return CommonTermListEntryTextInputView.prototype.getValue=function(){return this.input.getValue()},CommonTermListEntryTextInputView.prototype.setValue=function(value){this.input.setValue(value)},CommonTermListEntryTextInputView}(),CommonTermListEntryRadioInputView=function(){function CommonTermListEntryRadioInputView(name,element,values,valueChangedCall){this.label=new HTMLTextElement("p",null,"list-entry-label",name),this.input=new RadioButtonView(name,values),this.commonTerm=element;element=new HTMLBasicElement("div",null,"ct-list-entry-div");element.appendChildren([this.label,this.input.element]),this.element=element;for(var i=0;i<this.input.inputs.length;i++)this.input.inputs[i].setChangeEventListener(valueChangedCall)}return CommonTermListEntryRadioInputView.prototype.getValue=function(){return this.input.getValue()},CommonTermListEntryRadioInputView.prototype.setValue=function(value){this.input.setValue(value)},CommonTermListEntryRadioInputView}(),OpenButtonView=function(){function ListWrapperView(delegate){var _this=this;this.audioDescriptionListEntry=new CommonTermListEntryBooleanView("Audio Description Enabled",Model_1.CommonTerm.audioDescriptionEnabled,function(){return _this.editPreference()}),this.captionsEnabledListEntry=new CommonTermListEntryBooleanView("Captions Enabled",Model_1.CommonTerm.captionsEnabled,function(){return _this.editPreference()}),this.pictogramsEnabledListEntry=new CommonTermListEntryBooleanView("Pictograms Enabled",Model_1.CommonTerm.pictogramsEnabled,function(){return _this.editPreference()}),this.tableOfContentsListEntry=new CommonTermListEntryBooleanView("Table of Contents",Model_1.CommonTerm.tableOfContents,function(){return _this.editPreference()}),this.selfVoicingEnabledListEntry=new CommonTermListEntryBooleanView("Self-Voicing Enabled",Model_1.CommonTerm.selfVoicingEnabled,function(){return _this.editPreference()}),this.signLanguageEnabledListEntry=new CommonTermListEntryBooleanView("Sign Language Enabled",Model_1.CommonTerm.signLanguageEnabled,function(){return _this.editPreference()}),this.sessionTimeout=new CommonTermListEntryTextInputView("Session Timeout",Model_1.CommonTerm.sessionTimeout,function(){return _this.editPreference()}),this.signLanguage=new CommonTermListEntryTextInputView("Sign Language",Model_1.CommonTerm.signLanguage,function(){return _this.editPreference()}),this.displaySkiplinks=new CommonTermListEntryRadioInputView("Display Skiplinks",Model_1.CommonTerm.displaySkiplinks,[Model_1.SkipLinkValues.onfocus,Model_1.SkipLinkValues.always,Model_1.SkipLinkValues.never],function(){return _this.editPreference()}),this.listEntries=[this.audioDescriptionListEntry,this.captionsEnabledListEntry,this.pictogramsEnabledListEntry,this.tableOfContentsListEntry,this.selfVoicingEnabledListEntry,this.signLanguageEnabledListEntry,this.signLanguage,this.sessionTimeout,this.displaySkiplinks];for(var element=new HTMLBasicElement("div","ct-list-wrapper",null),i=0;i<this.listEntries.length;i++)element.appendChild(this.listEntries[i].element);this.element=element,this.delegate=delegate}return ListWrapperView.prototype.editPreference=function(){this.delegate.didEditPreferences(this)},ListWrapperView.prototype.getAllPreferences=function(){for(var preferences=[],i=0;i<this.listEntries.length;i++)preferences.push(new Model_1.UserPreference(this.listEntries[i].commonTerm,this.listEntries[i].getValue()));return preferences},ListWrapperView.prototype.setPreferences=function(preference){for(var i=0;i<this.listEntries.length;i++)preference.mediaFeature==this.listEntries[i].commonTerm&&this.listEntries[i].setValue(preference.value)},ListWrapperView}();exports.ListWrapperView=OpenButtonView;OpenButtonView=function(){function LoginWrapperView(delegate){var _this=this;this.usernameField=new HTMLUserInputElement("text","openape-username","text-input","Username"),this.usernameLabel=new HTMLTextElement("label",null,"openape-label","Username"),this.passwordField=new HTMLUserInputElement("password","openape-password","text-input","Password"),this.passwordLabel=new HTMLTextElement("label",null,"openape-label","Password"),this.openAPEImage=new HTMLImageElement("img","open-ape-logo",null,"https://gpii.eu/mq-5/assets/open-ape-logo.png","Open Ape Logo"),this.loginButton=new LabelButtonView("login-button","button","Login",function(){return _this.login()}),this.errorMessage=new HTMLTextElement("p","error-field",null,""),this.delegate=delegate,this.openAPEImage.addClickEventListener(this.openOpenAPE),this.element=new HTMLBasicElement("div","login-wrapper",null),this.element.appendChildren([this.openAPEImage,this.usernameLabel,this.usernameField,this.passwordLabel,this.passwordField,this.loginButton,this.errorMessage])}return LoginWrapperView.prototype.showErrorMessage=function(text){this.errorMessage.clearText(),this.errorMessage.appendText(text)},LoginWrapperView.prototype.login=function(){this.delegate.didPressLogin(this.usernameField.getValue(),this.passwordField.getValue(),this)},LoginWrapperView.prototype.openOpenAPE=function(){window.open("https://openape.gpii.eu")},LoginWrapperView}();exports.LoginWrapperView=OpenButtonView;OpenButtonView=function(){function OpenButtonView(element){var _this=this;this.hidePanelButton=new ImageButtonView("show-panel-button","button","https://gpii.eu/mq-5/assets/open.svg","Open Button",function(){return _this.showPanel()}),this.label=new HTMLTextElement("p","show-panel-label",null,"Change User Preferences"),this.delegate=element;element=new HTMLBasicElement("div","open-button-view",null);element.appendChildren([this.label,this.hidePanelButton]),this.element=element,this.element.addClickEventListener(function(){return _this.showPanel()})}return OpenButtonView.prototype.showPanel=function(){this.delegate.didPressShowPanel(this)},OpenButtonView}();exports.OpenButtonView=OpenButtonView},{"../model/Model":5}]},{},[3]);